<%
  rel_id = @release_id || (vr_exists ? VersionRelease.where(status: "Pending").pluck(:id)[0] : VersionRelease.pluck(:id)[0])
  vr_relations = @term.get_relationships_at_version_release(rel_id)
  %>

<script type="text/javascript">
  $(document).ready(function(){
      console.log("loaded");
      $('.language-selector:disabled').each(function(){
	  var $self = $(this);
	  var $p = $self.parent();
	  var $inp = $($p.children()[0]);
	  $inp.prop('readonly', true);
	  $hid_inp = $('<input type="hidden">');
	  $hid_inp.attr('name', $self.attr('name'));
	  $hid_inp.val($self.find('option:selected').map(function(i, v){return this.value}).get()[0]);
	  $p.append($hid_inp);
	  var $del_button = $($p.children()[3]).find('button');
	  $del_button.prop('disabled', true);
      })
  })
  //$.fn.modal.Constructor.prototype.enforceFocus = function() {};

</script>
    <%= f.input "relation_#{Relation::Pref_label}", collection: vr_relations[Relation::Pref_label], as: :language_labels_mei,
                input_html: { include_help: t("admin_help.preferred_term"),
                              help_label: 'Preferred Term',
                              tabindex: 14,},
                required: true, readonly: false, label: t("relations.#{Relation::Pref_label}")
    %>

    <%= f.input "relation_#{Relation::Label}", collection: vr_relations[Relation::Label], as: :language_labels_mei,
                input_html: { include_help: t("admin_help.other_preferred_terms"),
                              help_label: 'Other Preferred Terms',
                              tabindex: 14,},
                required: false, readonly: false, label: t("relations.#{Relation::Label}")
    %>

    <%= f.input "relation_#{Relation::Alt_label}", collection: vr_relations[Relation::Alt_label], as: :language_labels_mei,
                input_html: { include_help: t("admin_help.other_preferred_terms"),
                              help_label: 'Other Preferred Terms',
                              tabindex: 14,},
                required: false, readonly: false, label: t("relations.#{Relation::Alt_label}")
    %>

    <%= f.input "relation_#{Relation::Description}", collection: vr_relations[Relation::Description], as: :language_labels_mei,
                input_html: { include_help: t("admin_help.scope_note"),
                              help_label: 'Description (Scope Note)',
                              rows: '4', type: 'textarea',
                },
                required: true, readonly:false, label: t("relations.#{Relation::Description}")
	%>
    <%= f.input "relation_#{Relation::Broader}", as: :prefix_multi_select_v3, collection: vr_relations[Relation::Broader], collection2: @all_terms,
                input_html: { class: 'form-control', include_help: 'Broader terms for this term.', help_label: 'Broader', multiple: false }, include_blank: true, label: t("relations.#{Relation::Broader}")
    %>
    <%= f.input "relation_#{Relation::Narrower}", as: :prefix_multi_select_v3, collection: vr_relations[Relation::Narrower], collection2: @all_terms,
                input_html: { class: 'form-control', include_help: 'Narrower terms for this term.', help_label: 'Narrower', multiple: false }, include_blank: true, label: t("relations.#{Relation::Narrower}")
	%>
    <%= f.input "relation_#{Relation::Related}", as: :prefix_multi_select_v3, collection: vr_relations[Relation::Related], collection2: @all_terms,
                input_html: { class: 'form-control', include_help: 'Related terms for this term.', help_label: 'Related', multiple: false }, include_blank: true, label: t("relations.#{Relation::Related}")
	%>
    <%= f.input "relation_#{Relation::Lcsh_exact}", as: :lcsh_lookup, collection: vr_relations[Relation::Lcsh_exact], collection2: @LCSH_types,
                input_html: { class: 'form-control',  multiple: false }, include_blank: true, label: t("relations.#{Relation::Lcsh_exact}")
	%>
    <%= f.input "relation_#{Relation::Lcsh_close}", as: :lcsh_lookup, collection: vr_relations[Relation::Lcsh_close], collection2: @LCSH_types,
                input_html: { class: 'form-control',  multiple: false }, include_blank: true, label: t("relations.#{Relation::Lcsh_close}")
    %>

    <%= f.input "relation_#{Relation::History_note}", collection: vr_relations[Relation::History_note], as: :language_labels_mei,
                input_html: { rows: '4', type: 'textarea' },
                required: true, readonly:false, label: t("relations.#{Relation::History_note}")
	%>
    <%= f.input "relation_#{Relation::Contributors}", collection: vr_relations[Relation::Contributors], as: :language_labels_mei,
                input_html: { rows: '4', type: 'textarea' },
                required: true, readonly:false, label: t("relations.#{Relation::Contributors}")
	%>
    <%= f.input "relation_#{Relation::Sources}", collection: vr_relations[Relation::Sources], as: :language_labels_mei,
                input_html: { rows: '4', type: 'textarea' },
                required: true, readonly:false, label: t("relations.#{Relation::Sources}")
	%>    

    <br /><br />
